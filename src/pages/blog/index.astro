---
import Layout from '../../layouts/Layout.astro';
import { getBlogPosts } from '../../lib/contentful';

const posts = await getBlogPosts();
---

<Layout title="Blog - Justice & Associates" description="Legal insights and updates from our experienced team of attorneys.">
  <div class="container mx-auto px-6 py-12">
    <h1 class="text-4xl font-bold mb-12">Legal Insights</h1>
    
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      {posts.map((post) => {
        const imageUrl = post.featuredImage?.fields?.file?.url;
        const authorImage = post.author?.fields?.image?.fields?.file?.url;
        const authorName = post.author?.fields?.name;
        const authorTitle = post.author?.fields?.title;

        return (
          <article class="bg-white rounded-lg shadow-lg overflow-hidden">
            {imageUrl && (
              <img 
                src={`https:${imageUrl}?w=800&h=400&fit=fill`}
                alt={post.title}
                class="w-full h-48 object-cover"
              />
            )}
            <div class="p-6">
              <h2 class="text-xl font-semibold mb-2">
                <a href={`/blog/${post.slug}`} class="hover:text-blue-600">
                  {post.title}
                </a>
              </h2>
              <p class="text-gray-600 mb-4">{post.excerpt}</p>
              {authorName && (
                <div class="flex items-center">
                  {authorImage && (
                    <img 
                      src={`https:${authorImage}?w=40&h=40&fit=fill`}
                      alt={authorName}
                      class="w-10 h-10 rounded-full mr-3"
                    />
                  )}
                  <div>
                    <p class="font-semibold">{authorName}</p>
                    {authorTitle && (
                      <p class="text-sm text-gray-600">{authorTitle}</p>
                    )}
                  </div>
                </div>
              )}
            </div>
          </article>
        );
      })}
    </div>
  </div>
</Layout>
